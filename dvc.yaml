stages:
  clean_data:
    cmd: python app/clean_data.py
    deps:
      - app/clean_data.py
      - data/census.csv
    outs:
      - data/cleaned_census.csv
  segregate_data:
    cmd: python app/segregate.py
    params:
      - segregate_data.test_size
      - segregate_data.random_state
    deps:
      - app/segregate.py
      - data/cleaned_census.csv
    outs:
      - data/train_cleaned_census.csv
      - data/test_cleaned_census.csv
  train_model:
    cmd: python app/train_model.py
    params:
      - train_model.random_state
      - train_model.test_size
      - train_model.param_grid
    deps:
      - app/train_model.py
      - app/ml/data.py
      - app/ml/model.py
      - data/train_cleaned_census.csv
    outs:
      - model/model.pkl
      - model/encoder.pkl
      - model/lb.pkl
    metrics:
      - model/score.json:
          cache: false
  evaluate:
    cmd: python app/evaluate.py
    deps:
      - app/evaluate.py
      - app/ml/data.py
      - app/ml/model.py
      - data/test_cleaned_census.csv
      - model/model.pkl
      - model/encoder.pkl
      - model/lb.pkl
    outs:
      - model/slice_output.txt
